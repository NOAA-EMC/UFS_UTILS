<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>UFS_UTILS: /home/George.Vandenberghe/gh/git/u2/sorc/global_chgres.fd/chgres.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">UFS_UTILS
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chgres_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">chgres.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="chgres_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ad344b0a3c44aec05c1d3d8170d5527b1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad344b0a3c44aec05c1d3d8170d5527b1"></a>
program&#160;</td><td class="memItemRight" valign="bottom"><b>chgres</b></td></tr>
<tr class="separator:ad344b0a3c44aec05c1d3d8170d5527b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>IREDELL </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-09-10</dd></dl>
<p>THIS PROGRAM INTERPOLATES THE SIGMA, SURFACE AND NSST RESTART FILES FROM THE GLOBAL SPECTRAL MODEL TO THE FV3 CUBED SPHERE GRID.</p>
<p>THE PROCEDURE FOR CHANGING THE SIGMA FILE RESOLUTION IS THUS: WHEN THE SIGMA FILE IS SIGIO FORMAT (SPECTRAL COEFFICIENTS) THE DATA IS FIRST CONVERTED FROM SPECTRAL TO GRID POINT SPACE (A GLOBAL GAUSSIAN OR REGULAR LAT/LON GRID). THE DIMENSIONS OF THAT GLOBAL GRID ARE USER-SELECTABLE. BY DEFAULT, THE DIMENSIONS ARE DETERMINED FROM THE JCAP VALUE OF THE INPUT DATA. NO CONVERSION IS REQUIRED WHEN THE WHEN THE SIGMA FILE IS IN NEMSIO FORMAT AS THE DATA ARE ALREADY IN GRID POINT SPACE. IF THE USER SELECTS A NEW NUMBER OF VERTICAL LEVELS OR A DIFFERENT TYPE OF LEVEL (I.E., HYBRID OR SIGMA), THEN A VERTICAL INTERPOLATION IS PERFOMRED. THE DATA ARE THEN INTERPOLATED FROM THE GLOBAL GRID TO THE SIX TILES OF THE FV3 CUBED SPHERE GRID.</p>
<p>THE SURFACE FILE CONVERSION IS DONE FOR A SINGLE FV3 TILE ONLY. SO FOR A GLOBAL SIX TILE FV3 GRID, THIS PROGRAM MUST BE CALLED SIX TIMES. THE PROCEDURE FOR INTERPOLATING SURFACE DATA IS: NEAREST NEIGHBOR INTERPOLATION IS PERFORMED SO THAT LAND/NONLAND POINTS ON THE INPUT GRID ARE MAPPED TO LAND/NONLAND POINTS ON THE TARGET GRID. IF THE INPUT FILE CONTAINS LANDICE AND THE OUTPUT GRID IS TO HAVE LANDICE, THEN NONLAND IS MAPPED TO NONLAND, LANDICE IS MAPPED TO LANDICE, ICE FREE LAND IS MAPPED TO ICE FREE LAND. OPTIONALLY, THE CLIMO FIELDS SUCH AS ALBEDO, ROUGHNESS, ETC, MAY DETERMINED ON THE OUTPUT GRID FROM SFCCYCLE (WHICH IS CALLED FROM THE SURFACE CHGRES MODULE). THE LATTER IS RECOMMENDED WHEN CONVERTING FROM A LOW TO HIGH RESOLUTION GRID. THE LAND-SEA MASK ON THE TARGET FV3 TILE IS READ FROM FILE. SKIN AND SOIL TEMPERATURE OVER LAND ARE ADJUSTED FOR DIFFERENCES BETWEEN THE INPUT AND OUTPUT OROGRAPHY. LIQ SOIL MOISTURE IS CALCULATED ACCORDING TO THE ADJUSTED TEMP. OROGRAPHY ON THE TARGET FV3 TILE IS READ FROM THE SAME FILE AS THE FV3 LAND-SEA MASK. THE PROGRAM WILL ALSO CONVERT FROM TWO TO FOUR SOIL LAYERS AND VICE VERSA. IT WILL WILL INITIALIZE ALL LAND STATES FOR THE LANDICE PHYSICS IF DESIRED. THE PROGRAM WILL SCALE TOTAL SOIL MOISTURE FOR ANY DIFFERENCES IN SOIL TYPE BETWEEN THE INPUT AND OUTPUT GRIDS.</p>
<p>THE PROCEDURE FOR CONVERTING AN NSST FILE IS THUS: NEAREST NEIGHBOR INTERPOLATION IS USED TO MAP TO THE OUTPUT GRID AS SOME NSST FIELDS ARE NOT CONTINUOUS. NSST FIELDS ARE ONLY REQUIRED AT OPEN WATER POINTS. FOR CONSISTENCY, THESE OPEN WATER POINTS ARE DETERMINED BY THE FV3 LAND-SEA MASK OUTPUT FROM THE SURFACE FILE CONVERSION STEP (WHICH INCLUDES SEA ICE). THEREFORE, WHEN CONVERTING AN NSST FILE, A SURFACE RESTART FILE MUST ALSO BE CONVERTED. AS FOR THE SURFACE, THE NSST CONVERSION IS DONE FOR A SINGLE FV3 TILE ONLY.</p>
<p>PROGRAM HISTORY LOG:</p>
<ul>
<li>98-04-03 IREDELL</li>
<li>2007 JUANG, MOORTHI, GAYNO, F YANG, DORIS PAN</li>
<li>2008 MOORTHI S</li>
<li>2011-08-05 GAYNO G : ADDED CAPABILITY TO WORK WITH NSST FILES</li>
<li>2011 J. WANG : CHANGE HEADER FOR SIGIO TO NEMSIO FILE</li>
<li>2013 SARAH LU : REVISE NEWSIG (COPIED FROM GLOBAL_CHGRES.FD)</li>
<li>2014 MOORTHI S : MERGED TRUNK VERSION WITH NGAC VERSION (NEMSIO)</li>
<li>2015 MOORTHI S : ADDED OPTION TO USE BINARY OROGRAPHY</li>
<li>2015 IREDELL M : ADDED OPTION TO WRITE NEMSIO ON REDUCED GRID</li>
<li>2015 FANGLIN Y : ADDED THE LOGICAL RDGRID</li>
<li>2015-10-06 MOORTHI S : ADDED OPTION TO READ PAST ICS FROM TOM HAMILL FOR GEFS</li>
<li>2015-12-06 MOORTHI S : ADDED OPTION TO READ NEMSIO FILE WITHOUT P, DP, VEL (NOPDPVV)</li>
<li>2016-04-22 MOORTHI S : MERGE WITH JIM ABLES'S MODIFICATIONS ADDING LATITUDINAL DECOMPOSITION TO ENABLE CHANGING RESOLUTION FROM A NEMSIO FILE TO A NEMSIO FILE. UPGRADE THE CODE TO WORK FOR VERTICAL RESOLUTION CHANGE AND FIX SOME ADDITIONAL BUGS. ADDED NOPDPVV OPTION NOT TO OUTPUT P, DP AND VVEL</li>
<li>2016-04-27 MOORTHI S : FIXED A BUG FOR NOPDPVV=.FALSE.</li>
<li>2016-06-01 GAYNO G : OPTION TO PROCESS NSST FILES IN NEMSIO FORMAT</li>
<li>2017-01-27 GAYNO/GFDL : EXTENSIVE MODIFICATIONS TO INTERPOLATE GFS DATA TO FV3 CUBED SPHERE GRID.</li>
<li>2017-04-12 GAYNO : WRITE NSST RECORDS TO THE SURFACE NETCDF RESTART FILE. PREVIOUSLY, THE NSST RECORDS WERE WRITTEN</li>
</ul>
<p>NAMELISTS: NAMCHG:</p>
<ul>
<li>LEVS INTEGER NEW NUMBER OF ATMOSPHERIC LEVELS (DEFAULT: NO CHANGE FROM INPUT GFS DATA)</li>
<li>NTRAC INTEGER NEW NUMBER OF TRACERS (DEFAULT: NO CHANGE FROM INPUT GFS DATA)</li>
<li>LONB INTEGER NUMBER OF LONGITUDES - GFS GAUSSIAN INPUT GRID. ONLY USED WHEN INPUT GFS DATA IS SFCIO FORMAT. (DEFAULT: FROM INPUT GFS SFCIO DATA HEADER)</li>
<li>LATB INTEGER NUMBER OF LATITUDES - GFS GAUSSIAN INPUT GRID. ONLY USED WHEN INPUT GFS DATA IS SFCIO FORMAT. (DEFAULT: FROM INPUT GFS SFCIO DATA HEADER)</li>
<li>IDVC INTEGER NEW VERTICAL COORDINATE ID (1 FOR SIGMA, 2 FOR HYBRID, 3 GENERAL HYBRID) (DEFAULT: SAME AS INPUT GFS DATA)</li>
<li>IDVM INTEGER NEW VERTICAL MASS VARIABLE ID (1 FOR LN(PS) AND 2 FOR PS (KPA)) (DEFAULT: SAME AS INPUT GFS DATA).</li>
<li>IDSL INTEGER NEW TYPE OF SIGMA STRUCTURE (1 FOR PHILLIPS OR 2 FOR MEAN) (DEFAULT: SAME AS INPUT GFS DATA)</li>
<li>MQUICK INTEGER FLAG TO SKIP VERTICAL INTERPOLATION. USEFUL WHEN THE NUMBER AND TYPE OF VERTICAL LEVELS IS NOT CHANGING. ONLY ACTIVE WHEN INPUT GFS DATA IS NEMSIO FORMAT. (DEFAULT: 0 - DONT SKIP. TO SKIP, SET TO 1)</li>
<li>IDVT INTEGER NEW TRACER VARIABLE ID (DEFAULT: SAME AS INPUT GFS DATA)</li>
<li>LATCH INTEGER NUMBER OF GAUSSIAN LATITUDES TO PROCESS AT ONE TIME (DEFAULT: 8)</li>
<li>LSOIL INTEGER NEW NUMBER OF SOIL LAYERS (DEFAULT: NO CHANGE FROM INPUT GFS DATA).</li>
<li>IVSSFC INTEGER NEW VERSION NUMBER SFC FILE (DEFAULT: NO CHANGE FROM INPUT GFS DATA).</li>
<li>NVCOORD INTEGER NEW NUMBER OF VERTICAL COORDINATES (DEFAULT: NO CHANGE FROM INPUT GFS DATA)</li>
<li>IDRT SPECTRAL TO INTERMEDIATE GRID OPTION. WHEN INPUT GFS SIGMA FILE IS SIGIO FORMAT (SPECTRAL COEFFICIENTS), CHGRES FIRST CONVERTS TO A TO A GLOBAL GRID. THAT GLOBAL GRID IS IN TURN INTERPOLATED TO THE FV3 GRID TILES. THE IDRT OPTION CONTROLS WHAT GLOBAL GRID IS CHOSEN. DEFAULT IS '4' - GLOBAL GAUSSIAN GRID. CAN ALSO CHOOSE '0' - GLOBAL REGULAR LAT/LON GRID.</li>
<li>OUTTYP INTEGER NUMBER OF OUTPUT FILE TYPE. NOT USED YET. CURRENTLY, THE FV3 SIGMA AND SURFACE/NSST FILES ARE NETCDF FORMAT ONLY.</li>
<li>CHGQ0 SET NEGATIVE VALUES OF TRACERS TO ZERO: 0 FALSE; 1 TRUE.</li>
<li>REGIONAL FLAG FOR PROCESSING STAND-ALONE NEST. WHEN '1', REMOVE HALO FROM GRIDS AND CREATE AN ATMOSPHERIC BOUNDARY FILE. WHEN '2', CREATE BOUNDARY FILE ONLY. WHEN '0', PROCESS NORMALLY AS FOR A GLOBAL GRID. DEFAULT IS '0'.</li>
<li>HALO WHEN RUNNING A STAND-ALONE NEST, THIS SPECIFIES THE NUMBER OF ROWS/COLS FOR THE HALO.</li>
</ul>
<p>INPUT FILES: -UNIT 11 CHGRES.INP.SIG GFS SIGMA FILE (IN EITHER SIGIO OR NEMSIO FORMAT) -UNIT 13 CHGRES.INP.SIGLEVEL NEW VERTICAL STRUCTURE -UNIT 21 CHGRES.INP.SFC GFS SURFACE FILE (SFCIO OR NEMSIO FORMAT) -UNIT 17 CHGRES.INP.LPL3 WHEN GFS SIGMA FILE IS SIGIO (SPECTRAL), CHGRES FIRST CONVERTS TO A GLOBAL GAUSSIAN OR LAT/LON GRID. THIS GRID CAN BE REDUCED (# GRID POINTS DECREASES TOWARDS THE POLE). THIS FILE DEFINES THE REDUCED GRID. -UNIT 31 CHGRES.INP.NST NSST FILE FOR INPUT GRID (NSTIO OR NEMSIO FORMAT) NOTE: FV3GFS OUTPUTS NSST FIELDS IN THE SURFACE FILE - CHGRES.INP.SFC -UNIT ?? CHGRES.FV3.OROG.T[1-6] FV3 OROGRAPHY AND LAND MASK. ONE FILE FOR EACH SIX GLOBAL TILES (NETCDF FORMAT) -UNIT ?? CHGRES.FV3.GRD.T[1-6] FV3 GRID SPECS FILE. ONE FILE FOR EACH SIX GLOBAL TILES (NETCDF FORMAT) OUTPUT FILES: -UNIT ?? GFS_CTRL.NC FV3 ATMOSPHERIC HEADER FILE (NETCDF FORMAT) -UNIT ?? OUT.SFC.TILE[1-6].NC FV3 SURFACE/NSST DATA FILE (NETCDF FORMAT) ONE FILE FOR EACH SIX GLOBAL TILES. -UNIT ?? GFS_DATA.TILE[1-6].NC FVN ATMOSPHERIC FILE (NETCDF FORMAT). ONE FILE FOR EACH SIX GLOBAL TILES.</p>
<p>REMARKS: VALID VALUES OF IDVT ALL UNITS ARE SPECIFIC IN KG/KG </p>
<pre>
  IDVT  NTRAC 
     0      2    VAPOR,OZONE,CLOUD (DEFAULT OPERATIONAL)
     1      1    VAPOR,OZONE
     2      1    VAPOR,CLOUD
    21      2    VAPOR,OZONE,CLOUD
    12      2    VAPOR,CLOUD,OZONE
   100     20    SET 1: VAPOR,OZONE,CLOUD, AND INITIAL VALUES OF
                 CLAT*CLON,CLAT*SLON,SLAT,
                 V*SLON-U*SLAT*CLON,-V*CLON-U*SLAT*SLON,U*CLAT
                 ONE,K,SIGMA,PS,PRES,TEMP,ENTROPY,MOIST ENTROPY
                 VAPOR,OZONE,CLOUD
   200       5   IDEA tracer set with O and O2 in addition q, O3, clw
 </pre><p>NUMBER OF TRACERS FOR NEMSIO FILE:</p>
<ul>
<li>data holder q(:,:,ntraco_q)</li>
<li>ntraco_q=NTRAC_MET+NTRACO_AER</li>
<li>nemsio data header recname/reclevtyp/reclev, NTRAC=NTRAC_MET+NTRAC_AER</li>
<li>NTRAC_MET: meteorology tracerss, could be: spfh,ozn,cld</li>
<li>NTRAC_AER: aerosol tracer </li>
</ul>

<p>Definition in file <a class="el" href="chgres_8f90_source.html">chgres.f90</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a></li><li class="navelem"><a class="el" href="dir_930f33eb779540d7f7c1bc4e9f60c6c3.html">George.Vandenberghe</a></li><li class="navelem"><a class="el" href="dir_15eb563446e3f03882183ae99f4c04ae.html">gh</a></li><li class="navelem"><a class="el" href="dir_51954ab30e21df7c1df2db9108abc59d.html">git</a></li><li class="navelem"><a class="el" href="dir_db7811ab3a716cb1bcd7f249c213dc04.html">u2</a></li><li class="navelem"><a class="el" href="dir_e087b00f0a45c0b2fd8005a19f47bbcb.html">sorc</a></li><li class="navelem"><a class="el" href="dir_ed390e4dcbcc3222a384725dcb75cb76.html">global_chgres.fd</a></li><li class="navelem"><a class="el" href="chgres_8f90.html">chgres.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
