#!/bin/bash
set -x

rm -f to_upper_lower.F90.o utils.f90.o to_upper_lower

HOMEufs_util=$PWD/..
HOMEunit_test=$PWD

compiler=${compiler:-"intel"}

cd $HOMEufs_util/sorc
source machine-setup.sh
cd ..
module use ./modulefiles
module load build.$target.$compiler > /dev/null 1>&1
module list
cd $HOMEunit_test

unit_test_target="chgres_cube"

# /usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/bin/intel64/ifort -g -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/nemsio/2.5.2/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sfcio/1.4.1/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sigio/2.3.2/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/bacio/2.4.1/include_4 -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sp/2.3.3/include_d -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/w3nco/2.4.1/include_d -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/mod -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/include -I/gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/png/1.6.35/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/zlib/1.2.11/include -I/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/wgrib2/2.0.8/include  -g -traceback -r8 -convert big_endian -assume byterecl -O3 -fp-model precise   -qopenmp -c utils.f90 -o utils.f90.o

CMAKE_BINARY_DIR=$HOMEufs_util/build
ln -s $CMAKE_BINARY_DIR/sorc/${unit_test_target}.fd/CMakeFiles/${unit_test_target}.dir/utils.f90.o

/usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/bin/intel64/ifort -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/nemsio/2.5.2/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sfcio/1.4.1/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sigio/2.3.2/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/bacio/2.4.1/include_4 -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sp/2.3.3/include_d -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/w3nco/2.4.1/include_d -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/mod -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/include -I/gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/png/1.6.35/include -I/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/zlib/1.2.11/include -I/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/wgrib2/2.0.8/include  -g -traceback -r8 -convert big_endian -assume byterecl -O3 -qopenmp -c to_upper_lower.F90 -o to_upper_lower.F90.o
/usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/bin/intel64/ifort  -Xlinker --enable-new-dtags -Xlinker -rpath -Xlinker /usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/mpi/intel64/lib/release_mt -Xlinker -rpath -Xlinker /usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/mpi/intel64/lib -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib/release_mt -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib  -g -traceback -r8 -convert big_endian -assume byterecl -O3 utils.f90.o to_upper_lower.F90.o -o to_upper_lower -Wl,-rpath,/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib:/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/jpeg/9.1.0/lib:/gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/lib:/gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/lib/release_mt: /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/nemsio/2.5.2/lib/libnemsio.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sfcio/1.4.1/lib/libsfcio.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sigio/2.3.2/lib/libsigio.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/bacio/2.4.1/lib/libbacio_4.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/sp/2.3.3/lib/libsp_d.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/w3nco/2.4.1/lib/libw3nco_d.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/lib/libesmf.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/wgrib2/2.0.8/lib/libwgrib2.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/wgrib2/2.0.8/lib/libwgrib2_api.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib/libnetcdff.so /usrx/local/prod/intel/2018UP01/compilers_and_libraries/linux/lib/intel64_lin/libiomp5.so -Wl,-rpath,/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/lib -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/lib -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/zlib/1.2.11/lib -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/esmf/8_1_0_beta_snapshot_27/lib -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib -cxxlib -lrt -ldl -lnetcdff -lnetcdf -lz -ldl -lm -m64 -mcmodel=small -pthread -threads -Wl,--no-as-needed  -qopenmp /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/wgrib2/2.0.8/lib/libwgrib2.a /usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/jasper/2.0.22/lib64/libjasper.a /usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/jpeg/9.1.0/lib/libjpeg.so /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/png/1.6.35/lib64/libpng.a /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/zlib/1.2.11/lib/libz.a -lm /gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/lib/libmpifort.so /gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib/libnetcdf.so -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib -lnetcdf /gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/lib/release_mt/libmpi.so /gpfs/dell1/usrx/local/prod/intel/2018UP01/compilers_and_libraries_2018.1.163/linux/mpi/intel64/lib/libmpigi.a /usr/lib64/libdl.so /usr/lib64/librt.so -lpthread -L/gpfs/dell2/usrx/local/nceplibs/dev/hpc-stack/test/hpc-stack/ips/18.0.1.163/impi/18.0.1/netcdf/4.7.4/lib -lnetcdff -lirng -ldecimal -lcilkrts -lstdc++ -L/usrx/local/prod/packages/ips/18.0.1/hdf5/1.10.1/lib

date
